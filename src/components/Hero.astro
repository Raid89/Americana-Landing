---
import ButtonContact from "./ButtonContact.astro";
import { Image } from "astro:assets";
import YoutubePreview from "@images/yt-preview.jpg";
import "../styles/animations.css";


---

<section class="hero">
  <div class="hero-content animate-fade-in" data-animate>
    <div class="hero-text animate-slide-up" data-animate>
      <h1>Aprender inglés online de forma práctica y con propósito</h1>
      <h2>Clases de inglés conversacional dinámicas, reales y personalizadas. Aprende a hablar inglés con confianza y abre nuevas oportunidades.</h2>
      <ButtonContact href="/contacto" text="Contáctanos" className="animate-pop-in in-viewport" data-animate />
    </div>
    <div class="hero-video animate-fade-in-delay" data-animate>
      <div id="yt-facade" class="yt-facade" tabindex="0" role="button" aria-label="Reproducir video" style="position:relative;cursor:pointer;overflow:hidden;border-radius:14px;">
        <Image src={YoutubePreview} alt="Clase de Inglés para Principiantes" style="width:100%;display:block;aspect-ratio:16/9;height:100%;object-fit:cover;"  loading={"eager"} />
        <span class="yt-facade-play" style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(0,0,0,0.6);border-radius:50%;padding:18px;display:flex;align-items:center;justify-content:center;">
          <svg width="48" height="48" viewBox="0 0 48 48" fill="none"><circle cx="24" cy="24" r="24" fill="#fff" fill-opacity="0.8"/><path d="M20 17V31L32 24L20 17Z" fill="#ff8282"/></svg>
        </span>
      </div>
    </div>
  </div>
</section>

<script>
if (typeof window !== "undefined") {
  window.addEventListener("DOMContentLoaded", () => {
    // Animaciones viewport
    document.querySelectorAll('[data-animate]').forEach((el) => {
      if (el.classList.contains("in-viewport")) return;
      const observer = new window.IntersectionObserver(function(entries, observer) {
        entries.forEach(function(entry) {
          if (entry.isIntersecting) {
            entry.target.style.animationDelay = '0s';
            entry.target.classList.add("in-viewport");
            observer.unobserve(entry.target);
          }
        });
      }, { threshold: 0.01 });
      observer.observe(el);
    });
    // YouTube facade
    const ytFacade = document.getElementById('yt-facade');
    if (ytFacade) {
      const loadIframe = () => {
        if (ytFacade.dataset.loaded) return;
        ytFacade.dataset.loaded = 'true';
        const iframe = document.createElement('iframe');
        iframe.width = '899';
        iframe.src = 'https://www.youtube.com/embed/Z6GGAQOMX8c?autoplay=1';
        iframe.title = 'Clase de Inglés para Principiantes | TODO LO ESENCIAL EN UN VIDEO | Aprende Inglés desde Cero';
        iframe.frameBorder = '0';
        iframe.allow = 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share';
        iframe.referrerPolicy = 'strict-origin-when-cross-origin';
        iframe.allowFullscreen = true;
        iframe.style.width = '100%';
        iframe.style.aspectRatio = '16/9';
        iframe.style.borderRadius = '14px';
        ytFacade.replaceWith(iframe);
      };
      ytFacade.addEventListener('click', loadIframe);
      ytFacade.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') loadIframe();
      });
    }
  });
}
</script>

<style>
  .hero-content {
    display: flex;
    align-items: center;
    gap: 70px;
    justify-content: space-between;
    padding: 70px 100px;
  }

  .hero-text {
    display: flex;
    flex-direction: column;
    gap: 40px;
    width: 706px;
    min-width: 706px;

    h1 {
      font-size: 71px;
      font-weight: 600;
      margin: 0;
    }

    h2 {
      font-size: 20px;
      line-height: 30px;
      font-weight: 500;
      margin: 0;
    }
  }

  .hero-video {
    width: 100%;
    iframe {
      width: 100%;
      aspect-ratio: 16 / 9;
      border-radius: 14px;
    }
  }

  .yt-facade {
    background: #000;
    min-height: 200px;
    position: relative;
    aspect-ratio: 16/9;
    display: block;
  }
  .yt-facade-play {
    transition: background 0.2s;
  }
  .yt-facade:hover .yt-facade-play,
  .yt-facade:focus .yt-facade-play {
    background: rgba(255,130,130,0.9);
  }

  @media screen and (max-width: 1600px) {
    .hero-content {
      padding: 60px 40px;
    }

    .hero-text {
      width: 100%;
      min-width: unset;
      align-items: center;

      h1 {
        font-size: 50px;
      }

      h2 {
        font-size: 18px;
        line-height: 28px;
      }
    }

    .hero-video {
      width: 100%;
    }
  }

  @media screen and (max-width: 1600px) {
    .hero-text {
      gap: 20px;
      h1 {
        font-size: 40px;
      }

      h2 {
        font-size: 16px;
        line-height: 24px;
      }
    }
  }

  @media screen and (max-width: 1000px) {
    .hero-content {
      flex-direction: column;
      align-items: center;
      padding: 40px 20px;
    }

    .hero-text {
      width: 100%;
      text-align: center;

      h1 {
        font-size: 32px;
      }

      h2 {
        font-size: 14px;
        line-height: 22px;
      }
    }

    .hero-video {
      width: 100%;
    }
  }

</style>
